<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.practice.mapper.SchoolMapper">

    <select id="selectNameByAreaid" resultType="School" parameterType="int">
        select *
        from zhiyuan.school
        where areaid = #{areaid}
    </select>

    <select id="getSchoolByPro" resultType="School" parameterType="String">
        select *
        from zhiyuan.gaokao
        where spname = #{proname}
    </select>


    <resultMap id="getProBySchname" type="profession">
        <result property="description" column="description"/>
        <result property="subject" column="subject"/>
        <result property="major" column="major"/>
        <result property="pid" column="pid"/>
        <result property="proname" column="proname"/>
        <result property="timelength" column="timelength"/>
        <result property="classes" column="classes"/>
        <result property="job" column="job"/>
        <result property="graduate" column="graduate"/>
        <result property="code" column="code"/>
        <result property="sort" column="sort"/>
        <collection property="schools" ofType="School" javaType="ArrayList">
            <result property="scid" column="scid"/>
            <result property="name" column="name"/>
            <result property="areaname" column="areaname"/>
            <result property="areaid" column="areaid"/>
            <result property="description" column="scdes"/>
            <result property="acronym" column="acronym"/>
            <result property="region" column="region"/>
            <result property="reid" column="reid"/>
            <result property="usedname" column="usedname"/>
            <result property="foundingYear" column="foundingYear"/>
            <result property="department" column="department"/>
            <result property="iscombine" column="iscombine"/>
            <result property="is985" column="is985"/>
            <result property="is211" column="is211"/>
            <result property="isDoubleFirstClass" column="isDoubleFirstClass"/>
            <result property="firstClassNum" column="firstClassNum"/>
            <result property="facultyNum" column="facultyNum"/>
            <result property="academicianNum" column="academicianNum"/>
            <result property="changjiangScholarNum" column="changjiangScholarNum"/>
            <result property="teachersNum" column="teachersNum"/>
            <result property="undergraProNum" column="undergraProNum"/>
            <result property="postgraProNum" column="postgraProNum"/>
            <result property="doctorProNum" column="doctorProNum"/>
            <result property="mainLabNum" column="mainLabNum"/>
            <result property="undergraEnrollNum" column="undergraEnrollNum"/>
            <result property="postgraEnrollNum" column="postgraEnrollNum"/>
            <result property="schoolWeb" column="schoolWeb"/>
        </collection>

    </resultMap>

    <select id="getSchoolByName" resultMap="getProBySchname">
        select pro.*, sc.description scdes, sc.scid
        from zhiyuan.profession pro,
             zhiyuan.school sc,
#              zhiyuan.t_school_profession sc_pro
             zhiyuan.gaokao g
        where g.scid = sc.scid
          and g.spname = pro.proname
          and sc.name = #{name}
    </select>


    <select id="findAllSchool" resultType="school">
        select *
        from zhiyuan.school
        <where>
            <if test="areaId != null and areaId[0] != -1 ">
                areaid in
                <foreach collection="areaId" item="areaId" open="(" separator="," close=")">
                    #{areaId}
                </foreach>
            </if>
            <if test="type != null and type != ''">
                and type=#{type}
            </if>
            <if test="is985 != null and is985 != ''">
                and is985 =#{is985}
            </if>
            <if test="is211 != null and is211 != ''">
                and is211=#{is211}
            </if>
            <if test="isdoublefirstclass != null">
                and isDoubleFirstClass=#{isdoublefirstclass}
            </if>
        </where>
        order by `rank`
        limit #{offset},#{size}

    </select>



    <select id="findSchool" resultType="school">
        select *
        from zhiyuan.school
        where name = #{schoolname}
    </select>

    <select id="count" resultType="int">
        select count(1) from zhiyuan.school
        <where>
            <if test="areaId != null and areaId[0] != -1 ">
                areaid in
                <foreach collection="areaId" item="areaId" open="(" separator="," close=")">
                    #{areaId}
                </foreach>
            </if>
            <if test="type != null and type != ''">
                and type=#{type}
            </if>
            <if test="is985 != null and is985 != ''">
                and is985 =#{is985}
            </if>
            <if test="is211 != null and is211 != ''">
                and is211=#{is211}
            </if>
            <if test="isdoublefirstclass != null">
                and isDoubleFirstClass=#{isdoublefirstclass}
            </if>
        </where>
    </select>


</mapper>
